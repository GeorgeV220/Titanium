From 29365b08c09ed24878ac925d1a6b6d559c1eeaec Mon Sep 17 00:00:00 2001
From: Mariell Hoversholm <proximyst@proximyst.com>
Date: Thu, 30 Apr 2020 16:56:54 +0200
Subject: [PATCH] Implement [Paper-0206] Add Raw Byte ItemStack Serialization
 by Mariell Hoversholm


diff --git a/src/main/java/org/bukkit/UnsafeValues.java b/src/main/java/org/bukkit/UnsafeValues.java
index 568c83e3..ee915631 100644
--- a/src/main/java/org/bukkit/UnsafeValues.java
+++ b/src/main/java/org/bukkit/UnsafeValues.java
@@ -30,4 +30,10 @@ public interface UnsafeValues {
     Achievement getAchievementFromInternalName(String name);
 
     List<String> tabCompleteInternalStatisticOrAchievementName(String token, List<String> completions);
+
+    // Paper start
+    byte[] serializeItem(ItemStack item);
+
+    ItemStack deserializeItem(byte[] data);
+    // Paper end
 }
diff --git a/src/main/java/org/bukkit/inventory/ItemStack.java b/src/main/java/org/bukkit/inventory/ItemStack.java
index d9cff5b0..b40477b2 100644
--- a/src/main/java/org/bukkit/inventory/ItemStack.java
+++ b/src/main/java/org/bukkit/inventory/ItemStack.java
@@ -559,6 +559,26 @@ public class ItemStack implements Cloneable, ConfigurationSerializable {
         return result;
     }
 
+    // Paper start
+    /**
+     * Deserializes this ItemStack from raw NBT bytes.
+     *
+     * @param bytes bytes representing an item in NBT
+     * @return Deserialized ItemStack.
+     */
+    public static ItemStack deserializeBytes(byte[] bytes) {
+        return org.bukkit.Bukkit.getUnsafe().deserializeItem(bytes);
+    }
+
+    /**
+     * Serializes this ItemStack to raw bytes in NBT.
+     * @return bytes representing this item in NBT.
+     */
+    public byte[] serializeAsBytes() {
+        return org.bukkit.Bukkit.getUnsafe().serializeItem(this);
+    }
+    // Paper end
+
     /**
      * Get a copy of this ItemStack's {@link ItemMeta}.
      *
-- 
2.38.1.windows.1

